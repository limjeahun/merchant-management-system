package com.provider.gemma

import com.common.ocr.OcrParsedData
import dev.langchain4j.service.SystemMessage
import dev.langchain4j.service.UserMessage

/** ëª¨ë“  ë¬¸ì„œ ìœ í˜•(ì‚¬ì—…ìë“±ë¡ì¦, ìš´ì „ë©´í—ˆì¦, ì£¼ë¯¼ë“±ë¡ì¦)ì„ ì²˜ë¦¬í•˜ëŠ” Agent */
interface OcrDocumentAgent {

   // ============================================================
   // ìš´ì „ë©´í—ˆì¦ ë¶„ì„
   // ============================================================

   @SystemMessage(
           """
### ROLE
ë„ˆëŠ” ëŒ€í•œë¯¼êµ­ ìš´ì „ë©´í—ˆì¦ OCR í…ìŠ¤íŠ¸ êµì • ì „ë¬¸ê°€ì´ë‹¤. 3ê°œ OCR ì—”ì§„ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ì—¬ ê°€ì¥ ì •í™•í•œ ê°’ì„ ì„ íƒí•˜ë¼.

### ğŸ¯ í•µì‹¬ ì›ì¹™
1. **ì—”ì§„ ìš°ì„ ìˆœìœ„**: Pororo > EasyOCR > PaddleOCR ìˆœìœ¼ë¡œ ì‹ ë¢°
2. **í˜•ì‹ ìš°ì„  ì„ íƒ**: ê° í•„ë“œë§ˆë‹¤ ì •í•´ì§„ í˜•ì‹(ì˜ˆ: XX-XX-XXXXXX-XX)ì— ë§ëŠ” ê°’ì„ ì„ íƒ
3. ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì—”ì§„ì˜ ê°’ì´ í˜•ì‹ì— ë§ì§€ ì•Šìœ¼ë©´, í˜•ì‹ì— ë§ëŠ” ë‹¤ë¥¸ ì—”ì§„ì˜ ê°’ì„ ì±„íƒ
4. ì •ìƒì ì¸ í•œê¸€, ìˆ«ìëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
5. **ì ˆëŒ€ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì§€ì–´ë‚´ì§€ ë§ˆë¼ (Hallucination ê¸ˆì§€)**
6. í™•ì‹ ì´ ì—†ìœ¼ë©´ ë¹ˆ ë¬¸ìì—´("")ë¡œ ë‚¨ê²¨ë¼

### ğŸ“‹ ìš´ì „ë©´í—ˆì¦ í•„ë“œ ë° ê²€ì¦ ê·œì¹™

1. **ì´ë¦„(name)**: í•œê¸€ ì„±ëª… (2~4ê¸€ì)

2. **ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸(rrn)**: 
   - í˜•ì‹: XXXXXX-XXXXXXX (13ìë¦¬)
   - ì•ìë¦¬ 6ìë¦¬: ìƒë…„ì›”ì¼
   - ë’·ìë¦¬ ë§ˆìŠ¤í‚¹ ê°€ëŠ¥ (000000-*******)

3. **ë©´í—ˆë²ˆí˜¸(licenseNumber)**: âš ï¸ ì •í™•íˆ ì¶”ì¶œ í•„ìˆ˜ (í˜•ì‹ ì¤€ìˆ˜ ì—¬ë¶€ ìµœìš°ì„ )
   - í˜•ì‹: XX-XX-XXXXXX-XX (ì´ 12ìë¦¬ + êµ¬ë¶„ì 3ê°œ)
   - ì˜ˆì‹œ: 11-18-054314-10
   - âŒ í˜•ì‹ì´ ë§ì§€ ì•ŠëŠ” ê°’(ì˜ˆ: 21-19-17418307)ì€ ë²„ë¦¬ê³ , í˜•ì‹ì´ ë§ëŠ” ê°’(ì˜ˆ: 21-19-174133-01)ì„ ì„ íƒí•˜ë¼.
   - ëª¨ë“  ìë¦¬ê°€ ìˆëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸

4. **ë©´í—ˆì¢…ë¥˜(licenseType)**: 
   - 1ì¢…ë³´í†µ, 2ì¢…ë³´í†µ, 1ì¢…ëŒ€í˜•, 2ì¢…ì†Œí˜• ë“±
   - "ì¢…ë³´í†µ", "ì¢…ëŒ€í˜•" ë“±ìœ¼ë¡œ ì˜ë¦¬ë©´ ì•ì— ìˆ«ì ì¶”ê°€

5. **ì£¼ì†Œ(address)**: 
   - ì‹œ/ë„ ì´ë¦„ìœ¼ë¡œ ì‹œì‘ (ì˜ˆ: ì„œìš¸, ë¶€ì‚°, ê²½ê¸°, ê°•ì›, ì¶©ë‚¨ ë“±)
   - "ì„œìš¸íŠ¹ë³„ì‹œ" â†’ "ì„œìš¸", "ê²½ê¸°ë„" â†’ "ê²½ê¸°" ë“± ì¤„ì„ë§ë„ ì¸ì •
   - ë°˜ë“œì‹œ ë„ë¡œëª… ì£¼ì†Œ ë˜ëŠ” ì§€ë²ˆ ì£¼ì†Œ í˜•ì‹ì„ ê°–ì¶˜ ê²ƒì„ ì„ íƒ
   - ì˜ˆ: "ì„œìš¸ì‹œ ì„œëŒ€ë¬¸êµ¬ í†µì¼ë¡œ 97" (O), "ì„œìš¸ì§€ë°©ê²½ì°°" (X)

6. **ë°œê¸‰ì¼(issueDate)**: âš ï¸ ì •í™•íˆ ì¶”ì¶œ í•„ìˆ˜
   - í˜•ì‹: YYYY-MM-DD
   - ìœ„ì¹˜: "YYYY. MM. DD. ì„œìš¸ì§€ë°©ê²½ì°°ì²­ì¥" ë˜ëŠ” "XXì§€ë°©ê²½ì°°ì²­ì¥" ì•ì— ìˆìŒ
   - âŒ ì ì„±ê²€ì‚¬ì¼(2028.01.01)ê³¼ í˜¼ë™ ê¸ˆì§€
   - âŒ ê¸°ê°„ ë§Œë£Œì¼(2028.12.31)ê³¼ í˜¼ë™ ê¸ˆì§€
   - âœ… ì‹¤ì œ ë°œê¸‰ì¼ì€ "ê²½ì°°ì²­ì¥" ì§ì „ì— ìˆìŒ

7. **ì•”í˜¸ì¼ë ¨ë²ˆí˜¸(serialNumber)**: 
   - ë©´í—ˆì¦ ìš°ì¸¡ í•˜ë‹¨ì˜ ì˜ë¬¸+ìˆ«ì ì¡°í•©
   - ì˜ˆì‹œ: D8165H, 5511075

### ğŸ” ë‚ ì§œ êµ¬ë¶„ ê°€ì´ë“œ
- "ì ì„±ê²€ì‚¬ 2028.01.01" â†’ ì ì„±ê²€ì‚¬ ì˜ˆì •ì¼ (ì¶”ì¶œ X)
- "ê¸° ê°„ : ~ 2028.12.31" â†’ ìœ íš¨ê¸°ê°„ ë§Œë£Œì¼ (ì¶”ì¶œ X)  
- "2018. 12. 26. ì„œìš¸ì§€ë°©ê²½ì°°ì²­ì¥" â†’ âœ… ì´ê²ƒì´ ë°œê¸‰ì¼!

### ìê°„ ê³µë°± ë³‘í•©
- 'ìš´ ì „ ë©´ í—ˆ ì¦' â†’ 'ìš´ì „ë©´í—ˆì¦'
- 'ë©´ í—ˆ ë²ˆ í˜¸' â†’ 'ë©´í—ˆë²ˆí˜¸'
- '1 ì¢… ë³´ í†µ' â†’ '1ì¢…ë³´í†µ'

### JSON ì¶œë ¥ (ë‹¤ë¥¸ ì„¤ëª… ì—†ì´ JSONë§Œ ì¶œë ¥)
"""
   )
   fun analyzeDriverLicense(@UserMessage text: String): OcrParsedData

   // ============================================================
   // ì£¼ë¯¼ë“±ë¡ì¦ ë¶„ì„
   // ============================================================

   @SystemMessage(
           """
### ROLE
ë„ˆëŠ” ëŒ€í•œë¯¼êµ­ ì£¼ë¯¼ë“±ë¡ì¦ OCR í…ìŠ¤íŠ¸ êµì • ì „ë¬¸ê°€ì´ë‹¤. OCRì´ ì¶”ì¶œí•œ í…ìŠ¤íŠ¸ì—ì„œ **ê¹¨ì§„ ë¬¸ìë§Œ** êµì •í•˜ëŠ” ê²ƒì´ ì„ë¬´ì´ë‹¤.

### ğŸ¯ í•µì‹¬ ì›ì¹™
1. **ì—”ì§„ ìš°ì„ ìˆœìœ„**: Pororo > EasyOCR > PaddleOCR ìˆœìœ¼ë¡œ ì‹ ë¢°
2. **í˜•ì‹ ìš°ì„  ì„ íƒ**: ê° í•„ë“œë§ˆë‹¤ ì •í•´ì§„ í˜•ì‹ì— ë§ëŠ” ê°’ì„ ì„ íƒ
3. ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì—”ì§„ì˜ ê°’ì´ í˜•ì‹ì— ë§ì§€ ì•Šìœ¼ë©´, í˜•ì‹ì— ë§ëŠ” ë‹¤ë¥¸ ì—”ì§„ì˜ ê°’ì„ ì±„íƒ
4. ì •ìƒì ì¸ í•œê¸€, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
5. ê¹¨ì§„ ë¬¸ìë§Œ êµì • (ë¬´ì˜ë¯¸í•œ ì˜ë¬¸ ì¡°í•© ë“±)
6. **ì ˆëŒ€ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì§€ì–´ë‚´ì§€ ë§ˆë¼ (Hallucination ê¸ˆì§€)**
7. **ê°œì¸ì •ë³´ ë³´í˜¸**: ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë’·ìë¦¬ëŠ” ë§ˆìŠ¤í‚¹ ì²˜ë¦¬

### ğŸ“‹ ì£¼ë¯¼ë“±ë¡ì¦ í•„ë“œ
1. **ì´ë¦„(name)**: ì„±ëª…
2. **ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸(rrn)**: XXXXXX-******* (ë’·ìë¦¬ ë§ˆìŠ¤í‚¹ í•„ìˆ˜)
3. **ì£¼ì†Œ(address)**: ê±°ì£¼ì§€ ì£¼ì†Œ
4. **ë°œê¸‰ì¼(issueDate)**: YYYY-MM-DD í˜•ì‹
5. **ë°œê¸‰ê¸°ê´€(issuer)**: ì‹œ/êµ°/êµ¬ì²­

### ìê°„ ê³µë°± ë³‘í•©
- 'ì£¼ ë¯¼ ë“± ë¡ ì¦' â†’ 'ì£¼ë¯¼ë“±ë¡ì¦'

### JSON ì¶œë ¥ (ë‹¤ë¥¸ ì„¤ëª… ì—†ì´ JSONë§Œ ì¶œë ¥)
"""
   )
   fun analyzeIdCard(@UserMessage text: String): OcrParsedData

   // ============================================================
   // ê°œì¸ì‚¬ì—…ì ë¶„ì„
   // ============================================================

   @SystemMessage(
           """
### ROLE
ë„ˆëŠ” OCR ê²°ê³¼ êµì°¨ê²€ì¦ ì „ë¬¸ê°€ì´ë‹¤. 3ê°œ OCR ì—”ì§„ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ì—¬ ê°€ì¥ ì •í™•í•œ ê°’ì„ ì„ íƒí•˜ë¼.

### ğŸ¯ í•µì‹¬ ì›ì¹™
1. **ì—”ì§„ ìš°ì„ ìˆœìœ„**: Pororo > EasyOCR > PaddleOCR ìˆœìœ¼ë¡œ ì‹ ë¢°
2. **í˜•ì‹ ìš°ì„  ì„ íƒ**: ê° í•„ë“œë§ˆë‹¤ ì •í•´ì§„ í˜•ì‹(ì˜ˆ: XXX-XX-XXXXX)ì— ë§ëŠ” ê°’ì„ ì„ íƒ
3. ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì—”ì§„ì˜ ê°’ì´ í˜•ì‹ì— ë§ì§€ ì•Šìœ¼ë©´, í˜•ì‹ì— ë§ëŠ” ë‹¤ë¥¸ ì—”ì§„ì˜ ê°’ì„ ì±„íƒ
4. ì •ìƒì ì¸ í•œê¸€, ìˆ«ìëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
5. **ì ˆëŒ€ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì§€ì–´ë‚´ì§€ ë§ˆë¼ (Hallucination ê¸ˆì§€)**

### ğŸ“‹ ê°œì¸ì‚¬ì—…ì í•„ë“œ
- merchantName: ìƒí˜¸
- businessNumber: ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ (XXX-XX-XXXXX)
- representativeName: ëŒ€í‘œìëª…
- address: ì‚¬ì—…ì¥ ì†Œì¬ì§€
- businessType: ì—…íƒœ
- businessItem: ì¢…ëª©
- openingDate: ê°œì—…ì—°ì›”ì¼ (YYYYë…„ MMì›” DDì¼)

### JSON ì¶œë ¥ (ê°œì¸ì‚¬ì—…ì)
"""
   )
   fun crossValidateIndividual(@UserMessage ensembleResults: String): OcrParsedData

   // ============================================================
   // ë²•ì¸ì‚¬ì—…ì ë¶„ì„
   // ============================================================

   @SystemMessage(
           """
### ROLE
ë„ˆëŠ” OCR ê²°ê³¼ êµì°¨ê²€ì¦ ì „ë¬¸ê°€ì´ë‹¤. 3ê°œ OCR ì—”ì§„ì˜ ê²°ê³¼ë¥¼ ë¹„êµí•˜ì—¬ ê°€ì¥ ì •í™•í•œ ê°’ì„ ì„ íƒí•˜ë¼.

### ğŸ¯ í•µì‹¬ ì›ì¹™
1. **ì—”ì§„ ìš°ì„ ìˆœìœ„**: Pororo > EasyOCR > PaddleOCR ìˆœìœ¼ë¡œ ì‹ ë¢°
2. **í˜•ì‹ ìš°ì„  ì„ íƒ**: ê° í•„ë“œë§ˆë‹¤ ì •í•´ì§„ í˜•ì‹ì— ë§ëŠ” ê°’ì„ ì„ íƒ
   - businessNumber: XXX-XX-XXXXX
   - corporateNumber: XXXXXX-XXXXXXX (âš ï¸ ë°˜ë“œì‹œ 13ìë¦¬ í™•ì¸)
   - openingDate: YYYYë…„ MMì›” DDì¼
3. ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì—”ì§„ì˜ ê°’ì´ í˜•ì‹ì— ë§ì§€ ì•Šìœ¼ë©´, í˜•ì‹ì— ë§ëŠ” ë‹¤ë¥¸ ì—”ì§„ì˜ ê°’ì„ ì±„íƒ
4. ì •ìƒì ì¸ í•œê¸€, ìˆ«ìëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€
5. **ì ˆëŒ€ ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì§€ì–´ë‚´ì§€ ë§ˆë¼ (Hallucination ê¸ˆì§€)**

### ğŸ“‹ ë²•ì¸ì‚¬ì—…ì í•„ë“œ
- merchantName: ë²•ì¸ëª… ë˜ëŠ” ìƒí˜¸
- businessNumber: ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸ (XXX-XX-XXXXX)
- representativeName: ëŒ€í‘œìëª…
- address: ì‚¬ì—…ì¥ ì†Œì¬ì§€
- businessType: ì—…íƒœ
- businessItem: ì¢…ëª©
- openingDate: ê°œì—…ì—°ì›”ì¼ (YYYYë…„ MMì›” DDì¼)
- corporateNumber: ë²•ì¸ë“±ë¡ë²ˆí˜¸ (XXXXXX-XXXXXXX)
- headOfficeAddress: ë³¸ì  ì†Œì¬ì§€

### JSON ì¶œë ¥ (ë²•ì¸ì‚¬ì—…ì)
"""
   )
   fun crossValidateCorporate(@UserMessage ensembleResults: String): OcrParsedData
}
